# SDSSIL
Системы сбора событий и логов.

ББМО-02-23 Курченко И.Д.

## Практика № 4 Network Threat Hunting

# Скачиваем и разворачиваем образ.

![image](https://github.com/user-attachments/assets/c93d35b2-5028-4605-b2c4-48c1bc10191c)

Вход в систему по паролю hunting

![image](https://github.com/user-attachments/assets/2d362c22-5b8c-46fe-add9-444f28cbc229)

Логин и пароль для входа в веб-версию:

 Name: threat@activecountermeasures.com
 
 Pass: hunting2


![image](https://github.com/user-attachments/assets/fe58db63-72d6-44de-95c9-4e4c74dc38a3)

![image](https://github.com/user-attachments/assets/954addbe-f311-4d3b-9559-109ec6743f1c)

![image](https://github.com/user-attachments/assets/c2811983-ea00-43c5-8b9b-e9a00ea3b489)

![image](https://github.com/user-attachments/assets/a0360c14-b053-430c-8574-7a5c0252e92c)

![image](https://github.com/user-attachments/assets/5831d4af-a9f3-4225-9c51-44ef50b56c4b)


Импортируем логи

![image](https://github.com/user-attachments/assets/7f0527ef-fd2b-4043-9eb3-0ac3db52404d)

![image](https://github.com/user-attachments/assets/32a0067c-12c8-421e-9879-0c8787134699)

![image](https://github.com/user-attachments/assets/d4164376-1cbe-42df-81ae-c637b898adb1)

![image](https://github.com/user-attachments/assets/56ac8d08-621d-4309-8287-78b043426ea8)

Анализ всех адресов выявил следующее:

Высокий уровень согласованности метрик (99.70%)

Такой высокий уровень согласованности (кумулятивная метрика соответствия) может указывать на регулярные и четко организованные запросы от источника к целевому IP-адресу. Это может быть признаком Beaconing-а, когда зараженное устройство устанавливает связь с управляющим сервером (C2).

Общее количество соединений (3011)
Для одного IP-адреса это значительное количество соединений. Если такая активность характерна для сети, это может не быть аномалией. Однако, если подобная активность не ожидается (например, для обычного пользователя или устройства IoT), это может свидетельствовать о нежелательном поведении.
Равномерное распределение активности на графике

Использование HTTP без шифрования
Отсутствие HTTPS может указывать на то, что данные передаются в незашифрованном виде, что создает риски. Незащищенные протоколы часто используются для связи с C2-серверами.

Заключение
Практически все адреса связаны с Windows, поэтому мы добавляем их в белый список.


![image](https://github.com/user-attachments/assets/143e6762-d185-442f-8c5e-12bc05bf24a1)

![image](https://github.com/user-attachments/assets/4f703649-5412-488e-930b-f01d9e898b56)

Проверим эти адресы через вирустотал

![image](https://github.com/user-attachments/assets/173e655a-72a1-46aa-b549-1a9fab09c515)

![image](https://github.com/user-attachments/assets/e48f98de-13d7-4f6a-bf87-0714fda3f244)

![image](https://github.com/user-attachments/assets/fb1d340f-c4e7-4957-b376-ddfa86acd8c9)

Вирус тотал пометил один сайт как, подозрительный.

## Подозрительная природа доменов

Доменные имена, связанные с IP-адресами `piensorcad6302755c.aiihosted.com` и `demo1.aiihosted.com`, вызывают подозрения. Длинные, автоматически сгенерированные названия часто применяются злоумышленниками для маскировки своей деятельности. Эти домены связаны с поддоменами `aiihosted.com`, что может указывать на использование временной инфраструктуры, такой как фишинг, C2-серверы или ботнеты.

## Связь с DigitalOcean

Данный IP-адрес принадлежит хостинг-провайдеру DigitalOcean, который, как и другие публичные облачные провайдеры, часто используется для легальных целей. Тем не менее, злоумышленники также арендуют облачные серверы для осуществления вредоносной деятельности, включая:

- Развёртывание C2-серверов
- Проведение атак (например, DDoS и фишинг)

## Связь с файлом "7May2021_export_bookmark.html"

Хотя файл не был отмечен как вредоносный, его природа (экспорт закладок) может указывать на возможное использование IP-адреса для передачи данных. Это обстоятельство требует дополнительного анализа.


## lab 2

Импортируем логи и переключаемся на них.

![image](https://github.com/user-attachments/assets/000ff23c-cddd-498a-9e2f-6b398d9487fa)

![image](https://github.com/user-attachments/assets/4391d2bb-cbf9-40d9-8935-245c8e10db92)

![image](https://github.com/user-attachments/assets/6642a540-17f3-49a2-949e-7a337dc62ce3)

## Подозрительный домен: honestimnotevil.com

Название домена вызывает подозрения из-за своей провокационной природы ("честно, я не злой"), что может быть попыткой злоумышленников замаскировать свои намерения. Такие имена доменов часто используются в тестовых или вредоносных инфраструктурах.

## Большое количество запросов (2074 запросов)

Это аномальное количество DNS-запросов к одному домену может свидетельствовать о:

- Подключении к Command & Control серверу.
- Вредоносной программе, регулярно обращающейся к этому домену.

## Длинные поддомены

Примеры поддоменов:

- `...b7f9090b8e40bac43eb80a.honestimnotevil.com`
- `...291b4324545e080e82a0ea.honestimnotevil.com`

Длинные, случайно сгенерированные поддомены часто используются в доменной генерации (DGA — Domain Generation Algorithm), которая характерна для вредоносных программ. Каждый новый поддомен может быть связан с уникальной сессией или устройством, участвующим в ботнете.

## Связь с единственным хостом: 172.21.8.157

Все запросы направлены на один IP-адрес (172.21.8.157). Это может быть внутренний сервер или прокси для перенаправления запросов, но такой концентрации трафика стоит уделить внимание.

## Нет прямых соединений (Direct Connections = 0)

Отсутствие прямых соединений указывает на то, что злоумышленники могут использовать DNS-туннелирование для передачи данных через DNS-запросы. 

### Что меня смущает:

DNS-туннелирование или C2-активность. Количество запросов и странные поддомены сильно указывают на DNS-туннелирование или связь с Command & Control сервером.

## DGA (Domain Generation Algorithm)

Автоматически сгенерированные поддомены и подозрительный основной домен усиливают вероятность того, что это вредоносная инфраструктура.

## Аномальная активность в сети

Если это единственный хост (172.21.8.157), отправляющий такие запросы, он может быть скомпрометированным устройством.

## lab 3

Импортируем логи и переключаемся на них 

![image](https://github.com/user-attachments/assets/7d005fc9-24c2-4dd3-bba6-63a2dd1c2e08)

![image](https://github.com/user-attachments/assets/283240b9-e05c-49ff-960d-dd69b4ec3aff)

![image](https://github.com/user-attachments/assets/09d021c8-55db-44db-a3d9-8c8483f15066)

Здесь 2 адреса, проверяем их через вирус тотал.

![image](https://github.com/user-attachments/assets/3841e950-851e-44ae-96a9-985661c6d240)

![image](https://github.com/user-attachments/assets/442eb050-ee0d-4be3-9776-9d642ff3cf9c)

![image](https://github.com/user-attachments/assets/3c8e0872-c585-4f61-8d10-a91d9e7f6b6f)

## Связь с вредоносной активностью

### Метка DGA и упоминание Cobalt Strike

Наличие метки DGA и упоминание Cobalt Strike усиливают подозрения о том, что домен используется для управления вредоносной активностью. Алгоритмы генерации доменов (DGA) позволяют злоумышленникам динамически создавать множество доменных имен, что затрудняет их блокировку и обнаружение.

### Количество детекций

Один из сервисов отметил данный домен как вредоносный, что увеличивает вероятность его использования в атаках. Это подтверждает, что домены с меткой DGA часто используются для командно-управляющей связи (C2) и других вредоносных действий.

### Неопределённость IP-адреса

Анализ проводился 5 дней назад, что достаточно актуально для оценки текущей активности домена. Свежесть данных позволяет более точно оценить возможные угрозы и активность, связанную с данным доменом.

### Заключение

Общая информация о DGA и текущая активность домена указывают на высокую вероятность его использования в вредоносных целях. Необходим постоянный мониторинг и применение современных методов обнаружения для противодействия таким угрозам.
